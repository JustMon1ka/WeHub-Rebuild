# 开发需求文档模板

## PART1. 项目概述

### 1. 模块概述与业务目标

* **模块名称与定位**：
    本模块为“账号认证与用户信息管理模块”，在系统中负责用户的注册、登录、信息维护、密码重置及兴趣标签管理等功能。该模块是平台用户体系的基础，支撑用户身份识别、权限控制和个性化服务，是所有业务流程的入口和安全保障。
* **业务价值与目标**：
    提供安全、便捷的账号认证和用户信息管理功能。实现注册/登录流程、用户信息维护、用户标签体系，以及密码、个人信息的保护机制。
* **项目边界界定**：
    本模块仅负责用户身份认证、基础信息管理及标签体系，不涉及内容发布、社交互动、积分系统等业务逻辑。第三方登录、实名认证等扩展功能暂不在本阶段实现范围内。与内容管理、社交关系等模块通过用户ID进行数据关联。

### 2. 页面设计与功能流程
### 2.1 页面列表及结构

| 页面名称     | 功能简介                                                   |
| ------------ | ---------------------------------------------------------- |
| 用户注册页面 | 用户填写基本信息，完成账号注册流程                         |
| 用户引导界面 | 新用户首次登录时展示平台介绍、标签选择、社区推荐和功能引导 |
| 用户登录页面 | 用户输入凭证登录系统，支持密码找回入口                     |
| 密码重置页面 | 用户通过验证方式重置登录密码                               |
| 个人资料页面 | 展示和编辑用户资料、兴趣标签等信息                         |

页面跳转关系：
- 注册页面与登录页面可相互跳转。
- 注册成功后跳转至用户引导界面。
- 用户引导完成后进入首页。
- 登录成功后进入首页。
- 个人信息页面可跳转至和密码重置页面。
- 密码重置页面可从登录页面或个人信息页面访问。

### 2.2 界面原型或示意图（个人资料、登录界面、注册界面、用户引导界面、密码重置界面）
- **用户注册页面**  
    - 输入框：用户名、手机号/邮箱、验证码、密码、确认密码  
    - 按钮：注册、获取验证码、跳转至登录  
- **用户引导界面**  
    - 显示欢迎信息、平台介绍  
    - 选择感兴趣的标签
    - 推荐几个社区进行加入
    - 按钮：开始使用、跳过
- **用户登录页面**  
    - 输入框：用户名/手机号/邮箱、密码  
    - 按钮：忘记密码（跳转至密码重置页面）、登录（跳转至注册页面）  
- **个人信息页面**  
    - 显示：头像、昵称、联系方式等
    - 按钮：编辑资料（在本界面）、重置密码（跳转至密码重置页面）
- **密码重置页面**  
    - 输入框：手机号/邮箱、验证码、新密码
    - 按钮：获取验证码、提交、返回登录

### 2.3 功能流程

**用户注册流程**
1. 用户访问注册页面，填写信息并提交
2. 系统校验信息合法性（唯一性、格式等）
3. 注册成功，自动登录并进行用户引导

**用户引导流程**
1. 用户首次登录后进入引导界面
2. 展示平台介绍和功能
3. 用户选择兴趣标签
4. 根据标签推荐相关社区
5. 完成后跳转至首页

**用户登录流程**
1. 用户输入凭证，点击登录 
2. 系统验证身份，生成会话 
3. 登录成功，跳转至个人信息页面；失败则提示错误
4. 用户登陆后持久化保存，储存到Coockie中

**用户信息获取/更新流程**  
1. 用户进入个人信息页面  
2. 可查看和编辑部分资料  
3. 提交修改后，系统校验并保存，记录修改日志
4. 可以更新用户标签，删除或新增兴趣标签
5. 更新成功后提示用户

**密码重置流程**
1. 用户在登录或个人信息页面选择重置密码  
2. 输入绑定的手机号/邮箱，获取验证码  
3. 验证通过后设置新密码，系统保存并记录操作
4. 更新成功后提示用户

## PART2. 开发中的技术细节说明
### 3. 前端组件结构与交互说明
#### 3.1 组件列表与层次结构s

##### 将构建的页面：

- **注册页面（Register.vue）** ： 
    - 子组件：
        - 用户注册表单组件（RegisterForm.vue）
  
- **登录页面（Login.vue）**： 
    - 子组件：
        - 用户登录表单组件（LoginForm.vue）

- **用户引导页面（UserGuide.vue）**
    - 展示平台介绍、兴趣标签选择、社区推荐等
    - 子组件：
        - 标签选择组件（TagSelector.vue）：用户选择兴趣标签
        - 社区推荐组件（CommunityRecommend.vue）：需要社区模块提供后端接口

- **用户注册表单组件（RegisterForm.vue）**
    - 输入框：用户名、手机号/邮箱、验证码、密码、确认密码
    - 按钮：注册、获取验证码、跳转至登录页面
    - 验证逻辑：用户名唯一性、密码强度等

- **密码重置页面（ResetPassword.vue）**
    - 子组件：
        - 验证码验证表单（VerificationCodeForm.vue）
        - 新密码设置表单（NewPasswordForm.vue）

###### 将构建的组件：

- **用户登录表单组件（LoginForm.vue）**
    - 输入框：用户名/手机号/邮箱、密码
    - 按钮：登录、忘记密码（跳转至密码重置页面）、注册（跳转至注册页面）
    - 验证逻辑：凭证格式校验
    - 将这个组件单独拆分出来有助于设计一个弹窗式的登录组件，便于在其他页面复用。

- **个人信息页面组件（UserProfile.vue）**
    - 展示和编辑用户资料，包含资料编辑表单（ProfileEditForm.vue）。
    - 子组件：
        - 资料表单（ProfileEditForm.vue）
        - 兴趣标签管理组件（TagManager.vue）：

- **资料表单组件（ProfileEditForm.vue）**
    - 用户资料表单，包含用户头像上传、昵称、简介、出生日期、地址等字段。
    - 点击进行编辑，回车或点击页面的其他部分进行保存。

- **兴趣标签管理组件（TagManager.vue）**
    - 展示用户兴趣标签。
    - 支持添加、删除标签。

- **验证码验证表单组件（VerificationCodeForm.vue）**
    - 输入框：手机号/邮箱、验证码
    - 按钮：获取验证码、下一步

- **新密码设置表单组件（NewPasswordForm.vue）**
    - 输入框：新密码、确认密码
    - 按钮：提交新密码、返回登录页面

#### 3.2 组件交互逻辑
- **注册页面**：用户输入信息后，点击注册按钮，触发注册接口调用。若成功，则跳转至用户引导页面。
- **登录页面**：用户输入凭证后，点击登录按钮，触发登录，验证身份并生成会话。若成功，则跳转至个人信息页面。若失败，则提示错误信息。成功登录后，用户信息持久化保存到 Cookie 中。密码会加密成 MD5 格式存储和传输。
- **用户引导页面**：展示平台介绍、功能和推荐社区等信息。然后展示兴趣标签选择页面和社区推荐页面，用户选择兴趣标签并关注社区后，点击开始使用按钮，保存选择至后端并跳转至首页。
- **个人信息页面**：用户可查看和编辑个人资料，提交修改后触发更新接口调用。若成功，则提示更新成功，并记录修改日志；若失败，则提示更新失败。用户可以更新兴趣标签，添加或删除标签。
- **密码重置页面**：用户输入手机号/邮箱获取验证码，验证通过后进入设置新密码页面组件，触发重置密码接口调用。若成功，则提示更新成功。


#### 3.3 样式与规范
- 根据生成的页面代码，统一使用[tailwind](https://cdn.tailwindcss.com)引入 Tailwind CSS 进行样式设计。
- 使用 Google Fonts 的 Inter 字体，确保界面美观且易读。
- 使用[css](https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap)中的css文件
- 其他样式根据上述组件设计进行调整，确保符合设计规范。

### 4. 后端接口设计
#### 4.1 接口概览
| 接口名称     | 请求方法 | 路径                      | 用途                 |
| ------------ | -------- | ------------------------- | -------------------- |
| 用户注册     | POST     | /api/users/register       | 注册新用户           |
| 用户登录     | POST     | /api/users/login          | 用户登录获取token    |
| 获取用户信息 | GET      | /api/users/{id}           | 获取指定用户详细信息 |
| 更新用户信息 | PUT      | /api/users/{id}           | 修改用户资料         |
| 重置密码     | POST     | /api/users/reset-password | 重置用户密码         |
| 获取用户标签 | GET      | /api/users/{id}/tags      | 获取用户兴趣标签     |
| 更新用户标签 | PUT      | /api/users/{id}/tags      | 修改用户兴趣标签     |
#### 4.2 请求头与认证
所有接口除注册、登录以外，均需携带身份认证令牌。
示例：
Authorization: Bearer <JWT Token>
Content-Type: application/json
#### 4.3 请求参数说明
以“用户注册”为例：
| 参数名   | 类型   | 位置 | 含义                   | 是否必填 |
| -------- | ------ | ---- | ---------------------- | -------- |
| username | string | Body | 用户名                 | 是       |
| password | string | Body | 密码                   | 是       |
| email    | string | Body | 邮箱                   | 是       |
| phone    | string | Body | 手机号                 | 是       |
| tags     | array  | Body | 用户初始标签           | 否       |
| user_id  | string | Body | 用户id（系统自动生成） | 是       |
#### 4.4 响应结构说明
统一结构如下：
```bash
{
  "code": 200,
  "msg": "成功",
  "data": { ... }
}
```
失败示例：
```bash
{
  "code": 401,
  "msg": "未授权",
  "data": null
}
```
#### 4.5 错误码与异常
| code | 含义              |
| ---- | ----------------- |
| 400  | 参数错误          |
| 401  | 未认证或token失效 |
| 403  | 无权限操作        |
| 404  | 用户不存在        |
| 500  | 服务器内部错误    |

返回格式：
```bash
{
  "code": 400,
  "msg": "用户名已存在",
  "data": null
}
```

### 5.数据库设计
与模块相关的数据库表：
用户表 User：
| 字段名         | 数据类型     | 长度（B） | 说明         | 备注                   |
| -------------- | ------------ | --------- | ------------ | ---------------------- |
| USER\_ID       | NUMBER(\*,0) | 1-22      | 用户唯一标识 | PK（主键）             |
| USERNAME       | VARCHAR2     | 100       | 用户名       |                        |
| PASSWORD\_HASH | VARCHAR2     | 32        | 用户密码MD5  | 16进制表示，固定32字符 |
| EMAIL          | VARCHAR2     | 255       | 邮件地址     |                        |
| PHONE          | VARCHAR2     | 20        | 电话号码     |                        |


用户信息表 Profile：
| 字段名      | 数据类型     | 长度（B） | 说明         | 备注       |
| ----------- | ------------ | --------- | ------------ | ---------- |
| USER\_ID    | NUMBER(\*,0) | 1–22      | 用户唯一标识 | PK（主键） |
| AVATAR\_URL | VARCHAR2     | 255       | 头像URL      |            |
| GENDER      | VARCHAR2     | 10        | 性别         |            |
| BIRTHDAY    | DATE         | 7         | 生日         |            |
| LOCATION    | VARCHAR2     | 255       | 地址         |            |
| EXPERIENCE  | NUMBER(\*,0) | 1–22      | 经验值       |            |
| LEVEL       | NUMBER(\*,0) | 1–22      | 等级         |            |

用户标签表 UserTag:
| 字段名         | 数据类型         | 长度（B） | 说明     | 备注     |
| USER\_ID    | NUMBER(\*,0) | 1–22  | 用户唯一标识 | PK（主键） |
| TAG\_ID    | NUMBER(\*,0) | 1–22  | 标签唯一标识 | PK（主键） |

### 6. 权限与用户角色控制
#### 6.1 角色定义
本模块主要涉及以下用户角色：
| 角色     | 描述                             |
| -------- | -------------------------------- |
| 管理员   | 拥有系统最高权限，可管理所有用户 |
| 普通用户 | 仅可管理自己的个人信息           |

#### 6.2 权限策略（RBAC）
| 角色     | 权限操作                                          |
| -------- | ------------------------------------------------- |
| 管理员   | 获取/更新任意用户信息，管理用户标签、重置任意密码 |
| 普通用户 | 获取/更新自身信息，修改自己的兴趣标签             |

#### 6.3 前后端控制
前端控制：
普通用户无法看到“管理他人资料”的操作按钮；
管理员账号登录后，展示用户管理入口菜单；
后端校验：
所有敏感接口需校验 JWT Token 中的用户角色信息；
例如：更新他人资料接口需验证是否为管理员。

### 7. 第三方依赖与集成点说明
#### 7.1 第三方服务
- **用户身份验证**：集成 OAuth 2.0 认证服务，支持多种登录方式（如微信、QQ、GitHub 等）。
- **短信服务**：集成阿里云短信服务，用于用户注册、密码重置等场景的短信验证。

#### 7.2 数据库

