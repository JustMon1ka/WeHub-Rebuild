## PART1. 项目概述

### 1. 模块概述与业务目标

* **模块名称与定位**：

  **帖子发布与展示模块**：负责用户发布多媒体内容（文字、图片、视频）及展示帖子列表，支持社交互动功能（点赞、评论、转发等）。该模块是平台内容生产的核心，直接影响用户活跃度和内容多样性。

  **帖子搜索与推荐模块**：提供内容检索和个性化推荐功能，帮助用户快速发现感兴趣的内容，提升用户留存率和平台粘性。

* **业务价值与目标**：

  **帖子发布与展示模块**：

  - 目标：为用户提供流畅的内容发布和互动体验，提升用户生成内容（UGC）的数量和质量。
  - 价值：增强社区活跃度，促进用户间互动，形成良性内容生态。
  - 成功指标：日均发帖量、互动率（点赞/评论/转发）、用户停留时长。

  **帖子搜索与推荐模块**：

  - 目标：通过精准搜索和个性化推荐，提高内容分发效率，满足用户兴趣需求。
  - 价值：提升用户满意度，增加平台使用频率。
  - 成功指标：搜索成功率、推荐内容点击率、用户留存率。

* **项目边界界定**：

  **帖子发布与展示模块**：

  - 包含：帖子发布、展示、互动（点赞/评论/转发）、标签系统、话题统计。
  - 不包含：用户账号管理（属于账号认证模块）、私信功能（属于用户社交模块）。

  **帖子搜索与推荐模块**：

  - 包含：模糊搜索、内容推荐、热门话题推荐、用户搜索。
  - 不包含：用户关注关系管理（属于用户社交模块）、圈子内容推荐（属于兴趣圈子模块）。

### 2. 页面设计与功能流程

* **页面列表及结构**：

  **帖子发布与展示模块**：

  - **帖子发布页**：
    - 功能：用户输入文字、上传图片/视频、添加标签。
    - 跳转关系：发布后跳转至帖子详情页。
  - **帖子列表页**：
    - 功能：按时间或热度展示帖子列表，支持分页加载。
    - 跳转关系：点击帖子跳转至帖子详情页。
  - **帖子详情页**：
    - 功能：展示帖子内容、评论列表、互动按钮（点赞/评论/转发）。
    - 跳转关系：点击评论跳转至评论输入框。

  **帖子搜索与推荐模块**：

  - **搜索页**：
    - 功能：提供搜索框，支持关键词搜索帖子和用户。
    - 跳转关系：点击搜索结果跳转至帖子详情页或用户主页。
  - **推荐内容页**：
    - 功能：展示个性化推荐帖子列表，支持刷新加载新内容。
    - 跳转关系：点击帖子跳转至帖子详情页。
  - **热门话题页**：
    - 功能：展示热门话题标签及关联帖子。
    - 跳转关系：点击标签跳转至话题详情页。

* **界面原型或示意图**：提供主要页面的线框图或效果图（可手绘或使用原型工具），标注关键交互元素（如按钮、输入框、导航等）和布局要点。

* **功能流程图**：

  **帖子发布操作：**

  ```mermaid
  graph TD
      A[用户点击发布按钮] --> B[进入发布页面]
      B --> C{填写内容}
      C -->|输入文字| D[支持富文本编辑]
      C -->|上传媒体| E[选择图片/视频]
      E --> F[预览媒体内容]
      F --> G{添加标签}
      G -->|手动输入| H[输入标签名称]
      G -->|选择推荐标签| I[从热门标签中选择]
      H & I --> J[点击发布按钮]
      J --> K{系统验证}
      K -->|内容合法| L[发布成功，跳转至帖子详情页]
      K -->|内容为空| M[提示“内容不能为空”]
      K -->|媒体过大| N[提示“文件大小超限”]
      M & N --> B
  ```

  **点赞/取消流程操作：**

  ```mermaid
  graph TD
      A[用户浏览帖子] --> B[点击点赞按钮]
      B --> C{当前状态}
      C -->|未点赞| D[发送点赞请求]
      D --> E[更新按钮为“已点赞”]
      C -->|已点赞| F[发送取消点赞请求]
      F --> G[更新按钮为“未点赞”]
      E & G --> H[实时更新点赞数显示]
  ```

  **评论/回复操作：**

  ```mermaid
  graph TD
      A[用户在帖子详情页] --> B{操作类型}
      B -->|点击主评论按钮| C[展开评论输入框]
      B -->|点击回复按钮| D[自动填充对目标用户]
      C --> E[输入评论内容]
      D --> E
      E --> F{内容校验}
      F -->|通过| G[提交至服务器]
      F -->|不通过| H[显示错误提示]
      H --> E
      G --> I{提交结果}
      I -->|成功| J[刷新评论列表]
      I -->|失败| K[提示 '发布失败，请重试']
      K --> E
      J --> L[显示新评论/回复]
      L --> M[高亮新增内容]
  ```

  **转发帖子：**

  ```mermaid
  graph TD
      A[用户点击转发按钮] --> B[弹窗选择转发方式]
      B -->|直接转发| C[自动生成转发内容]
      B -->|添加评论转发| D[输入附加文字]
      C & D --> E[确认转发]
      E --> F[更新原帖转发数]
      F --> G[跳转至用户个人主页]
  ```

  **收藏帖子：**

  ```mermaid
  graph TD
      A[用户点击收藏按钮] --> B{当前状态}
      B -->|未收藏| C[发送收藏请求]
      C --> D[更新按钮为“已收藏”]
      B -->|已收藏| E[发送取消收藏请求]
      E --> F[更新按钮为“未收藏”]
      D & F --> G[同步更新收藏列表]
  ```

  **模糊搜索流程：**

  ```mermaid
  graph TD
      A[用户进入搜索页] --> B[输入关键词]
      B --> C[实时显示搜索建议]
      C --> D{选择搜索类型}
      D -->|搜索帖子| E[按相关性排序结果]
      D -->|搜索用户| F[按粉丝数排序结果]
      E & F --> G[点击结果跳转至详情页]
      G -->|无结果| H[显示“暂无相关内容”]
  ```

  **内容推荐流程：**

  ```mermaid
  graph TD
      A[用户打开推荐页] --> B{推荐策略}
      B -->|基于兴趣标签| C[优先展示标签匹配内容]
      B -->|基于历史行为| D[推荐相似用户喜欢的帖子]
      C & D --> E[分页加载推荐列表]
      E --> F[用户点击帖子]
      F --> G[记录点击行为，优化下次推荐]
  ```

  **热度推荐流程：**

  ```mermaid
  graph TD
      A[系统定时统计] --> B[计算标签热度]
      B --> C[生成TOP10热门话题]
      C --> D[推送给用户]
      D --> E[用户点击话题标签]
      E --> F[展示关联帖子列表]
  ```

  ##### 关键交互说明

  1. **异常处理**：
     - 所有操作需增加网络请求失败、权限不足等异常分支（如提示“网络异常，请重试”）。
  2. **实时更新**：
     - 点赞数、评论数等需通过WebSocket或轮询实现实时更新。
  3. **数据验证**：
     - 发布/评论内容需过滤敏感词（调用风控接口），媒体文件需校验格式和大小。

## PART3. 开发策略与约定

### 8. 状态管理方案

* **全局状态管理**：说明前端状态管理方案，如使用 Vuex（或 Pinia）进行集中式状态管理。Vuex 是 Vue.js 的官方状态管理库，采用集中式存储管理组件状态，确保状态变化可预测。
* **模块状态划分**：描述各状态仓库模块（store module）对应的功能域，例如用户信息、订单数据、全局配置等。列出每个状态模块包含的 state、getter、mutation、action 的主要字段。
* **数据流动示意**：说明前端组件如何通过 dispatch/commit 操作全局状态，状态更新流程，及与后端接口的数据交互。例如：登陆成功后 `commit('setUser', userInfo)` 更新用户状态。

### 9. 输入校验、异常处理与边界场景考虑

* **输入验证**：前后端需共同验证输入数据的合法性，包括必填字段、数据格式、长度范围、值域限制等。说明采用的验证规则（正则表达式、枚举、范围校验等），例如邮箱格式、密码长度等。针对表单和 API 接口均需描述校验逻辑。
* **异常处理**：定义错误处理策略：接口返回的状态码规则（如 4xx 表示客户端错误，5xx 表示服务器错误等）；应用层抛出的错误信息规范；前端友好提示方案。列举可能的异常场景，如数据库约束冲突、缓存失效、调用第三方失败等，并说明处理方式（重试、降级或返回特定错误码）。
* **边界与特殊情况**：考虑边界条件和异常输入。例如，输入超出允许范围、缺失必填字段、数据类型不匹配、特殊字符/注入攻击等。对这些情况应返回明确的错误信息（通常为 4xx 错误码）并记录日志。还应考虑并发冲突（如重复提交、乐观锁冲突返回 409）和系统负载高时的退避处理（如 429 限流）。

### 10. 开发约定与注意事项

* **编码规范**：[Typescript](https://google.github.io/styleguide/tsguide.html) | [C#](https://google.github.io/styleguide/csharp-style.html) | [Others](https://google.github.io/styleguide/)
* **开发流程**：说明代码仓库主分支（master）为当前最新全功能分支（需保证任何时候都可用），余下为各开发小组的开发分支（不保证任何时候都可用，由开发小组内部规定），提交信息规范（[多人提交冲突参考](https://zhuanlan.zhihu.com/p/584834288)）：
```txt
新增：
1、<文件路径>：<做了什么>
...
修改：
1、<文件路径>：<做了什么>
...
删除：
1、<文件路径>：<做了什么>
...
```
* **环境配置**：.NET 8.0.412版本、pnpm 10.10.0、Node 22.15.0。
* **前端兼容**：Chrome/Edge、Firefox、Safari。
* **日志与监控**：约定日志格式、日志级别使用（Info/Warning/Error），及错误监控告警方式。

### 11. 接口联调与 Mock 策略

* **联调计划**：说明后端接口开发完成后的联调流程，如接口测试完成标准、前后端联调会议、接口稳定性确认等。列出用于联调的测试账号和接口文档链接。
* **Mock 数据方案**：在后端接口尚未就绪时，可使用 Mock 技术模拟接口返回数据，以提升开发效率。例如，可在 Vue 项目中使用 Mock.js 或 JSON 文件提前构造测试数据，使前端开发与接口定义并行进行。文档中可说明 Mock 服务的搭建方式和数据格式规范。
* **测试**：在`/Tests/`下建立对应的测试，写好对应的测试流程。