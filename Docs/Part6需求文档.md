# 开发需求文档模板

## PART1. 项目概述
### 0. 对其他模块的需求
** 接口待定 **
1. 在用户主界面展示用户的帖子列表，前端调用帖子组件。
   期望的形式：
   - 前端：有一个帖子列表组件，接收用户ID，展示该用户的帖子列表。
   - 后端：需提供接口 `/api/posts/user/{id}`，接收用户ID，返回该用户的帖子列表。
2. 在用户主界面展示用户的帖子、回复、点赞列表，前端调用帖子组件。
   期望的形式：
   - 前端：有一个帖子列表组件，接收用户ID，展示该用户的帖子列表。
   - 后端：需提供接口 `/api/posts/user/{id}`，接收用户ID，返回该用户的帖子列表。
   - 前端：有一个回复列表组件，接收用户ID，展示该用户的回复列表。
   - 后端：需提供接口 `/api/replies/user/{id}`，接收用户ID，返回该用户的回复列表。
   - 前端：有一个点赞列表组件，接收用户ID，展示该用户的点赞列表。
   - 后端：需提供接口 `/api/likes/user/{id}`，接收用户ID，返回该用户的点赞列表。
3. 需要后端api返回关注数量和被关注数量
4. 需要在关注、被关注列表以外添加一个第三栏目：访客列表，该模块存疑？
   - 方案一：前端：有一个访客列表组件，接收用户ID，展示该用户的访客列表（**希望直接复用关注列表和被关注列表的组件**）。
   - 方案二：后端：将提供接口 `/api/users/{id}/visitors`，接收用户ID，返回该用户的访客列表，由关注列表对应的前端调用。
5. 投票创建需要在帖子创建页面中输入"/vote /question /multi /option"等关键字，自动生成投票。
   - 后端：将提供接口 `/api/votes`，接收投票信息，创建投票。


### 1. 模块概述与业务目标
#### 模块名称与定位

本模块为“用户成长与互动模块”，在系统中负责管理用户的成长体系与互动功能。其核心功能包括用户等级与权限管理、投票与打分机制、访客查看等，旨在提升用户活跃度和社区互动性。模块定位为用户个人中心的扩展，服务于用户成长激励和社区氛围建设。

#### 业务价值与目标

通过等级与权限系统激励用户持续活跃；提供投票功能；访客查看功能帮助用户了解主页访问情况，促进用户间的交流与关注。

#### 项目边界界定

- 本模块仅负责用户成长相关的业务逻辑与接口实现，不涉及帖子、回复、点赞等内容的具体管理与展示（由其他模块负责）。
- 用户等级与权限管理不涉及具体的权限内容，仅提供一个等级查看接口，权限应该分布在前端的各个位置控制。
- （或后端储存每个等级的权限位图，查询传入用户以及权限枚举常量，返回对应等级对应权限是Ture or False？无法添加功能，位图无法扩展）
- 投票功能将作为帖子组件实现，不实现单独的投票结果统计界面，投票创建界面等。投票组件将集成在帖子创建页面中，用户可以在帖子中直接创建和参与投票。只提供投票创建的接口，没有对应的创建组件，但有对应的投票展示和结果查看组件。
- 不负责用户注册、登录、基础信息管理等账号相关功能。
- 访客查看仅统计主页访问，不涉及详细行为追踪或隐私敏感数据处理。

### 2. 页面设计与功能流程
### 2.1 页面列表及结构

| 页面名称   | 功能简介                                         |
| ---------- | ------------------------------------------------ |
| 用户主页面 | 显示用户头像、昵称、个人信息、注册时间等基本资料 |
| 投票组件   | 提供投票创建、参与和结果查看功能                   |

页面跳转关系：
- 个人主页点击关注和关注者数量可以跳转到对应的用户列表页面。
- 个人主页点击个人信息编辑按钮可以跳转到个人信息页面。

### 2.2 界面原型或示意图（个人资料、个人主页、登录界面、注册界面、用户引导界面、密码重置界面）
- **用户主页面** 
    - 可以复用在所有用户页面，根据用户设置选择进行展示，比如隐藏发帖、回复、点赞等信息，让只有关注者看到/所有人都看不到
    - 显示：用户头像、昵称、个人简介、兴趣标签、关注数量、关注者数量、帖子数量
    - 按钮：编辑资料（跳转至个人信息页面，此按钮只有在当前用户的页面显示）
    - 子页面：用户发布的帖子列表、回复列表、点赞列表（由其他组实现）

- **投票组件**
    - 显示：投票标题、问题及选项列表、投票截止时间、投票后结果查看
    - 按钮：选择选项界面、提交投票（提交后直接查看结果）
    - 创建：在帖子创建页面中输入"/vote /question /multi /option"等关键字，自动生成投票，**由帖子创建模块实现**。

### 2.3 功能流程

**用户信息获取/更新流程**  
1. 用户进入个人信息页面  
2. 可查看和编辑部分资料  
3. 提交修改后，系统校验并保存，记录修改日志
4. 可以更新用户标签，删除或新增兴趣标签
5. 更新成功后提示用户

**投票创建与参与流程**
1. 用户在帖子创建页面输入关键字，并在帖子创建后自动生成投票组件
2. 用户可以在帖子中查看投票组件并参与投票
3. 提交投票后，系统记录投票结果并显示

## PART2. 开发中的技术细节说明
### 3. 前端组件结构与交互说明
#### 3.1 组件列表与层次结构
##### 将设计的页面：

- **用户主页面（UserHome.vue）**
    - 负责展示用户主页，包括用户基本信息、帖子列表、回复列表、点赞列表。
    - 子组件：
        - 用户信息卡片（UserProfileCard.vue）：用户简介展示
        - 帖子列表 -> **交由其他组实现**
        - 回复列表 -> **交由其他组实现**
        - 点赞列表 -> **交由其他组实现**

##### 将设计的组件：

- **用户信息卡片组件（UserProfileCard.vue）**
    - 显示用户头像、昵称、个人简介、兴趣标签、关注数量、关注者数量、帖子数量。
    - 提供编辑资料按钮，跳转至个人信息页面。

- **投票组件（Vote.vue）**
    - 负责展示投票信息、选项列表、投票结果。

#### 3.2 组件交互逻辑

- **用户主页面（UserHome.vue）**
    - 通过 props 接收用户ID，向后端请求用户信息和帖子列表数据。
    - 根据查看的用户类型：自身、关注者、其他用户，展示不同的信息。

- **投票组件（Vote.vue）**
    - 接收投票数据（标题、选项、截止时间等）作为 props。
    - 用户选择选项后，通过 `$emit` 触发投票提交事件，父组件处理投票逻辑。
    - 投票结果通过 props 返回，展示在组件中。

#### 3.3 样式与规范
- 根据生成的页面代码，统一使用[tailwind](https://cdn.tailwindcss.com)引入 Tailwind CSS 进行样式设计。
- 使用 Google Fonts 的 Inter 字体，确保界面美观且易读。
- 使用[css](https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap)中的css文件
- 其他样式根据上述组件设计进行调整，确保符合设计规范。

#### 4. 用户成长与互动模块
##### 4.1 接口概览
| 接口名称     | 方法 | 路径                       | 用途                       |
| ------------ | ---- | -------------------------- | -------------------------- |
| 获取用户等级 | GET  | /api/users/{id}/level      | 查询用户当前等级           |
| 获取经验记录 | GET  | /api/users/{id}/experience | 获取用户经验值变化记录     |
| 发起投票     | POST | /api/votes                 | 创建一个新的投票           |
| 投票         | POST | /api/votes/{id}/vote       | 用户参与投票               |
| 获取投票结果 | GET  | /api/votes/{id}/result     | 查看某个投票的结果         |
| 打分         | POST | /api/ratings               | 用户对对象打分             |
| 获取打分记录 | GET  | /api/ratings/{targetId}    | 获取某对象评分情况         |
| 查看访客列表 | GET  | /api/users/{id}/visitors   | 获取访问当前用户主页的访客 |
##### 4.2 请求头与认证
同样需要：
Authorization: Bearer <token>
Content-Type: application/json
| 参数名        | 类型              | 位置 | 含义         | 是否必填 |
| ------------- | ----------------- | ---- | ------------ | -------- |
| title         | string            | Body | 投票标题     | 是       |
| options       | array             | Body | 投票选项列表 | 是       |
| deadline      | string (datetime) | Body | 截止时间     | 是       |
| isMultiChoice | boolean           | Body | 是否允许多选 | 是       |
##### 4.4 响应结构说明
与账号模块统一格式，如：
{
  "code": 200,
  "msg": "投票成功",
  "data": {
    "voteId": 123
  }
}
##### 4.5 错误码与异常
与上节一致，补充示例：
| code | 含义       |
| ---- | ---------- |
| 409  | 重复投票   |
| 410  | 投票已过期 |
